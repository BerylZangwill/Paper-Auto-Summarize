# 📚 论文身份卡自动提取工具

一个基于 LLM 的学术论文批量分析工具，自动从 PDF 论文中提取结构化信息，生成"论文身份卡"，帮助研究者快速掌握领域研究热点、筛选精读文献。

## 🎯 适用场景

- **备考复试**：快速了解目标专业的研究热点和核心议题
- **文献综述**：批量处理大量论文，提取关键信息建立文献库
- **研究选题**：发现领域趋势，识别研究空白
- **日常阅读**：建立个人论文知识库，高效管理文献

## ✨ 核心功能

| 功能 | 说明 |
|------|------|
| 🗂️ 主题桶管理 | 根据配置文件自动创建分类文件夹 |
| 📄 PDF文本提取 | 自动提取PDF全文内容 |
| 🤖 LLM智能分析 | 调用大模型提取论文核心信息 |
| 📊 结构化输出 | 生成JSON身份卡 + CSV汇总表 |
| 🔄 断点续跑 | 已处理文件自动跳过，支持增量处理 |
| 💬 交互式操作 | 灵活选择处理范围，支持覆盖重跑 |

## 📁 项目结构

```
paper-card-extractor/
├── auto_runner.py              # 主脚本
├── prompt_paper_extraction.md  # Prompt模板
├── theme_buckets.md               # 主题桶配置（可自定义）
├── 00_inbox_pdfs/                 # PDF输入目录
│   ├── 教育数智化与智能治理/
│   │   ├── 01_论文A.pdf
│   │   └── 02_论文B.pdf
│   └── 教育治理与治理体系现代化/
│       └── 01_论文C.pdf
├── 01_extracted_json/             # JSON输出目录
│   ├── 教育数智化与智能治理/
│   │   ├── 01_论文A.json
│   │   └── 02_论文B.json
│   └── 教育治理与治理体系现代化/
│       └── 01_论文C.json
├── 02_summary_csv/                # CSV输出目录
│   ├── 教育数智化与智能治理.csv   # 分主题CSV
│   ├── 教育治理与治理体系现代化.csv
│   └── _all_papers.csv            # 总汇总CSV
└── error_log.txt                  # 错误日志
```

## 🚀 快速开始

### 1. 环境准备

```bash
# 安装依赖
pip install openai pymupdf

# 设置 API Key（以 DeepSeek 为例）
# Windows CMD
set DEEPSEEK_API_KEY=your_api_key_here

# Windows PowerShell
$env:DEEPSEEK_API_KEY="your_api_key_here"

# Linux / macOS
export DEEPSEEK_API_KEY="your_api_key_here"
```

### 2. 配置主题桶

编辑 `theme_buckets.md`，定义你的研究主题分类：

```markdown
## 你的主题1
- 次级标签A
- 次级标签B

## 你的主题2
- 次级标签C
- 次级标签D
```

### 3. 运行脚本

```bash
python auto_runner.py
```

### 4. 按提示操作

```
============================================================
  📚 论文身份卡自动提取工具 v2.0
============================================================

📁 检查配置文件...
   ✅ Prompt模板: prompt_paper_extraction.md
   ✅ 主题桶配置: theme_buckets.md
   ✅ PDF目录: 00_inbox_pdfs

📂 同步文件夹结构...
   从主题桶配置中解析到 10 个主题
   ✅ 新建: 教育政策与行政执行
   ⏩ 已存在: 9 个文件夹（跳过）
   同步完成

🔑 测试API连接...
   ✅ API连接成功

📊 扫描PDF文件...

┌──────┬──────────────────────────────────┬────────┬────────┬────────┐
│ 序号 │           文件夹名称             │ PDF总数│ 已处理 │ 待处理 │
├──────┼──────────────────────────────────┼────────┼────────┼────────┤
│ [1]  │ 教育数智化与智能治理             │   40   │   30   │   10   │
│ [2]  │ 教育治理与治理体系现代化         │   25   │    0   │   25   │
├──────┼──────────────────────────────────┼────────┼────────┼────────┤
│ 合计 │                                  │   65   │   30   │   35   │
└──────┴──────────────────────────────────┴────────┴────────┴────────┘

请选择操作模式:
  [A] 全部执行 - 处理所有待处理的PDF（跳过已处理）
  [R] 全部重跑 - 重新处理所有PDF（覆盖已有结果）
  [S] 选择执行 - 选择特定文件夹处理
  [Q] 退出
```

## 📋 输出格式

### JSON 身份卡示例

```json
{
  "title": "区块链赋能区域教育治理：逻辑、框架与路径",
  "authors": "郑旭东, 狄璇, 岳婷燕",
  "year": 2022,
  "venue": "现代远程教育研究",
  "doi": "10.3969/j.issn.1009-5195.2022.01.004",
  "keywords": ["区域教育治理", "教育数据治理", "区块链技术"],
  "domain_tags": ["教育数智化与智能治理", "区块链", "教育治理体系"],
  "paper_type": "理论研究",
  "problem": "区域教育治理存在理念缺失、结构失衡等问题",
  "research_object": "区域（省域）教育治理体系",
  "methodology": "文献分析、逻辑推演与框架构建",
  "conclusion": "区块链技术可通过四层框架实现数据驱动的教育善治",
  "contribution": "构建了数据源层-平台层-组织层-场景层的四层实践框架",
  "abstract": "区域教育治理现代化是国家教育现代化的重要组成部分...",
  "source_folder": "教育数智化与智能治理"
}
```

### CSV 字段说明

| 字段 | 说明 |
|------|------|
| 标题 | 论文标题 |
| 作者 | 前三位作者（逗号分隔） |
| 年份 | 发表年份 |
| 期刊 | 发表刊物 |
| DOI | 数字对象标识符 |
| 关键词 | 作者标注的关键词 |
| 领域标签 | 主题桶 + 次级标签 |
| 论文类型 | 综述/实证研究/理论研究/案例研究/政策分析/方法研究 |
| 研究问题 | 论文要解决的核心问题 |
| 研究对象 | 研究的对象是谁/什么 |
| 研究方法 | 采用的研究方法 |
| 核心结论 | 主要发现（1-2句话） |
| 主要贡献 | 创新点（1句话） |
| 来源文件夹 | PDF所在的主题文件夹 |

## 📝 PDF 命名规范

建议使用数字前缀命名，确保处理顺序与CSV行顺序一致：

```
01_区块链赋能教育治理_郑旭东.pdf
02_人工智能赋能教育评价_王某某.pdf
03_大数据驱动教育决策_李某某.pdf
...
09_智慧教育平台建设_张某某.pdf
10_教育数字化转型_陈某某.pdf
```

> ⚠️ 注意：使用两位数字前缀（01, 02, ..., 09, 10），避免排序问题

## ⚙️ 配置说明

### 切换 API 服务商

编辑 `auto_runner.py` 中的配置区域：

```python
# DeepSeek（默认）
API_KEY = os.environ.get("DEEPSEEK_API_KEY", "")
BASE_URL = "https://api.deepseek.com"
MODEL_NAME = "deepseek-chat"

# OpenAI
# API_KEY = os.environ.get("OPENAI_API_KEY", "")
# BASE_URL = "https://api.openai.com/v1"
# MODEL_NAME = "gpt-4o"

# 其他兼容 OpenAI 接口的服务商
# BASE_URL = "https://your-api-endpoint.com/v1"
```

### 调整请求参数

```python
REQUEST_TIMEOUT = 180.0   # API超时时间（秒）
REQUEST_INTERVAL = 5      # 请求间隔（秒），避免频率限制
MAX_PDF_CHARS = 30000     # PDF文本最大字符数，超出截断
```

## 🔧 常见问题

### Q: API 连接失败？

1. 检查环境变量是否正确设置
2. 检查 API Key 是否有效
3. 检查网络连接是否正常

### Q: JSON 解析失败？

可能原因：
- 模型返回格式不规范
- PDF 内容提取不完整

解决方法：
- 检查 `error_log.txt` 查看具体错误
- 重新运行，使用覆盖模式处理失败的文件

### Q: 中文路径报错？

Python 3.8+ 对中文路径支持良好，如遇问题：
- 确保使用 UTF-8 编码
- 避免路径中包含特殊字符

### Q: 如何处理新增的论文？

直接将新 PDF 放入对应主题文件夹，重新运行脚本选择 `[A] 全部执行`，已处理的文件会自动跳过。

## 📊 后续分析建议

拿到 CSV 汇总表后，可以进行以下分析：

| 分析类型 | 方法 |
|----------|------|
| 关键词词频 | 统计 `关键词` 列，发现高频主题 |
| 年份趋势 | 按 `年份` 分组，观察主题热度变化 |
| 方法分布 | 统计 `论文类型`，了解领域研究范式 |
| 作者网络 | 分析 `作者` 列，识别核心研究者 |
| 精读筛选 | 按 `论文类型=综述` 筛选，快速建立领域认知 |

## 📄 License

MIT License

## 🤝 致谢

- [DeepSeek](https://www.deepseek.com/) - 提供 LLM API 服务
- [PyMuPDF](https://pymupdf.readthedocs.io/) - PDF 文本提取
